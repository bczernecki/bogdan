---
title: "R Notebook"
output: html_notebook
---

 Próby wyliczanek z nowymi danymi dla PKB
 
```{r}
library(tidyverse, quietly = T)
pkb = readRDS("data/pkb.rds")
dane = spread(pkb[,1:3], key = mm, value=gdp )

```



Tutaj coś nowego dodać:

```{r2, echo=TRUE}
cbind(1993:2019, apply(dane[,-1], 1, which.max))


pkb2 = pkb
pkb2$mm = pkb2$yy + (1/4*1:4-0.15)
head(pkb2)
pkb2$mm2 = 1:4
model = lm(gdp~mm+I(mm^2)+as.factor(mm2), data=pkb2)

sekwencja = seq.Date(as.Date("1993-01-01"), as.Date("2019-12-31"), by = "quarter")

plot(sekwencja, pkb$gdp, type= 'l', 
     main = 'wydaje mi sie, ze jest przesuniecie 1996-2001', 
     ylab = 'na czerwono wielomian 2-giego stopnia')
lines(sekwencja, predict(model), col='red')

#
```


```{r, echo = T}
library(forecast)
trend_pkb = ma(pkb2, order = 4, centre = T)
pkb2 = ts(pkb$gdp/1000, frequency = 4, start = c(1993,1), end = c(2019,4))
decompose_pkb = decompose(pkb2, "additive")
plot(decompose_pkb)
```